diff --git a/tmp/8ac67b74-da14-489b-a42a-a02b16d6c67f_buggy.java b/tmp/221c1210-0a6d-4eb0-b750-62b7358b1413_fixed.java
index e69de29..a1357db 100644
--- a/tmp/8ac67b74-da14-489b-a42a-a02b16d6c67f_buggy.java
+++ b/tmp/221c1210-0a6d-4eb0-b750-62b7358b1413_fixed.java
@@ -0,0 +1,27 @@
+private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
+    in.defaultReadObject();
+    try {
+        final Object collectionClazz = in.readObject();
+        if (!(collectionClazz instanceof Class)) {
+            throw new UnsupportedOperationException("Deserialization failed: collectionClazz is not a Class");
+        }
+        final Class<?> clazz = (Class<?>) collectionClazz;
+        if (!Collection.class.isAssignableFrom(clazz)) {
+            throw new UnsupportedOperationException("Deserialization failed: collectionClazz is not assignable to Collection");
+        }
+        // Only allow standard collection types to be deserialized for safety
+        if (!(clazz.equals(ArrayList.class) ||
+              clazz.equals(LinkedList.class) ||
+              clazz.equals(HashSet.class) ||
+              clazz.equals(TreeSet.class) ||
+              clazz.equals(LinkedHashSet.class) ||
+              clazz.equals(Vector.class) ||
+              clazz.equals(Stack.class) ||
+              clazz.equals(PriorityQueue.class))) {
+            throw new UnsupportedOperationException("Deserialization failed: unsafe clazz " + clazz.getName());
+        }
+        this.collectionClass = clazz;
+    } catch (IOException | ClassNotFoundException ex) {
+        throw ex;
+    }
+}
\ No newline at end of file
