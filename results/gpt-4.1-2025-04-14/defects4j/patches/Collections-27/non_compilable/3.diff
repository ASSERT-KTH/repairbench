diff --git a/tmp/f6f2a3af-8e87-42dc-8faf-bc3c1b67c7f2_buggy.java b/tmp/81051d50-5d59-4cb9-8e6a-8171f7c3dd9d_fixed.java
index e69de29..44eeb40 100644
--- a/tmp/f6f2a3af-8e87-42dc-8faf-bc3c1b67c7f2_buggy.java
+++ b/tmp/81051d50-5d59-4cb9-8e6a-8171f7c3dd9d_fixed.java
@@ -0,0 +1,16 @@
+private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
+    in.defaultReadObject();
+
+    // Added security check for valueCollection type
+    if (valueCollection != null) {
+        String className = valueCollection.getName();
+        if (!ArrayList.class.getName().equals(className) &&
+            !LinkedList.class.getName().equals(className) &&
+            !HashSet.class.getName().equals(className) &&
+            !LinkedHashSet.class.getName().equals(className) &&
+            !TreeSet.class.getName().equals(className) &&
+            !Vector.class.getName().equals(className)) {
+            throw new UnsupportedOperationException("Unsafe valueCollection class deserialized: " + className);
+        }
+    }
+}
\ No newline at end of file
