diff --git a/tmp/3768f019-b6de-440e-b455-7c1356cb17d1_buggy.java b/tmp/6d4061f6-0687-40c2-8f28-be4ba1b94739_fixed.java
index e69de29..7f6b734 100644
--- a/tmp/3768f019-b6de-440e-b455-7c1356cb17d1_buggy.java
+++ b/tmp/6d4061f6-0687-40c2-8f28-be4ba1b94739_fixed.java
@@ -0,0 +1,9 @@
+@Override
+public void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {
+    stream.defaultReadObject();
+    // Implement safe guard against unsafe class during deserialization
+    if (!(collectionClass.equals(ArrayList.class))) {
+        throw new UnsupportedOperationException("Only ArrayList is supported during deserialization");
+    }
+    map = (Map<K, Collection<V>>) stream.readObject();
+}
\ No newline at end of file
