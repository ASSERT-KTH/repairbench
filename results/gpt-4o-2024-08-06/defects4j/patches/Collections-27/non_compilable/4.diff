diff --git a/tmp/f5ada702-98ac-4b7a-9189-5cb7e81913bd_buggy.java b/tmp/dc376590-f991-474b-9fb9-72ff1b7a3b35_fixed.java
index e69de29..7f6b734 100644
--- a/tmp/f5ada702-98ac-4b7a-9189-5cb7e81913bd_buggy.java
+++ b/tmp/dc376590-f991-474b-9fb9-72ff1b7a3b35_fixed.java
@@ -0,0 +1,9 @@
+@Override
+public void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {
+    stream.defaultReadObject();
+    // Implement safe guard against unsafe class during deserialization
+    if (!(collectionClass.equals(ArrayList.class))) {
+        throw new UnsupportedOperationException("Only ArrayList is supported during deserialization");
+    }
+    map = (Map<K, Collection<V>>) stream.readObject();
+}
\ No newline at end of file
